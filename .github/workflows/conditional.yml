name: conditional

on:
    workflow_dispatch:

jobs:
    job_a:
        name: a1
        runs-on: ubuntu-latest
        steps:
            - run: echo "A"
            - id: set
              run: |
                echo "{run_job_b}={no}" >> $GITHUB_OUTPUT
        outputs:
            run_job_b: ${{steps.set.outputs.run_job_b}}
    
    job_b:
        name: b1
        runs-on: ubuntu-latest
        needs:
            - job_a
        if: needs.job_a.outputs.run_job_b == 'yes'
        steps:
            - run: echo "B"
    
    job_c:
        name: c1
        runs-on: ubuntu-latest
        needs:
            - job_a
            - job_b
        if: |
            always() &&
            (needs.job_a.result == 'success' &&
            (needs.job_b.result == 'success' || needs.job_b.result == 'skipped')
            )
        steps:
            - run: echo "C"
    
    slack_job:
        name: Post to a Slack channel
        runs-on: ubuntu-latest
        steps:
            name: Send Slack notification
            id: slack
            uses: slackapi/slack-github-action@v1.27.0
            with:
                channel-id: 'my_chanel_id'
                slack-message: |
                GitHub result: ${{ job.status }}
                ${{ github.event.pull_request.html_url || github.event.head_commit.url }}
            env:
                SLACK_TOKEN: ${{ secrets.MY_SLACK_TOKEN }}